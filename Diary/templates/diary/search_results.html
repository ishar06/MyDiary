{% extends "base.html" %}

{% block title %}Search Results{% endblock %}

{% block content %}
<style>
    body {
        background: url('/static/images/img10.jpg') no-repeat center center fixed;
        background-size: cover;
        min-height: 100vh;
    }

    .search-header {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }

    [data-theme="dark"] .search-header {
        background: rgba(33, 37, 41, 0.95);
    }

    .entry-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        transition: transform 0.2s;
    }

    [data-theme="dark"] .entry-card {
        background: rgba(33, 37, 41, 0.95);
    }

    .entry-card:hover {
        transform: translateY(-2px);
    }

    .entry-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .entry-title {
        margin: 0;
        color: var(--primary-color);
    }

    .entry-date {
        font-size: 0.9rem;
        color: #666;
    }

    .mood-indicator {
        font-size: 1.5rem;
        margin-right: 0.5rem;
    }

    .entry-actions {
        margin-top: 1rem;
        display: flex;
        gap: 0.5rem;
    }

    .btn-action {
        padding: 0.25rem 0.75rem;
        font-size: 0.9rem;
    }

    [data-theme="dark"] .entry-date {
        color: #aaa;
    }

    .no-results {
        text-align: center;
        padding: 3rem;
        background: var(--background-color);
        border-radius: 10px;
        margin-top: 2rem;
    }

    .mood-filter {
        display: inline-block;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        margin: 0.25rem;
        color: var(--text-color);
        text-decoration: none;
        transition: background-color 0.2s;
    }

    .mood-filter:hover {
        background-color: rgba(74, 144, 226, 0.1);
        text-decoration: none;
    }

    .mood-filter.active {
        background-color: var(--primary-color);
        color: white;
    }

    .mood-happy { color: #ffd700; }
    .mood-sad { color: #6c757d; }
    .mood-angry { color: #dc3545; }
    .mood-lonely { color: #6610f2; }
    .mood-depressed { color: #343a40; }
    .mood-excited { color: #fd7e14; }
    .mood-peaceful { color: #20c997; }
</style>

<div class="search-header">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">
            {% if query %}
                Search Results for "{{ query }}"
            {% else %}
                {% if current_mood %}
                    Entries with {{ current_mood|title }} Mood
                {% else %}
                    All Entries
                {% endif %}
            {% endif %}
        </h2>
        <a href="{% url 'home' %}" class="btn btn-outline-primary">
            <i class="bi bi-house"></i> Back to Home
        </a>
    </div>

    <div class="mood-filters">
        <a href="?" class="mood-filter {% if not current_mood %}active{% endif %}">
            <span class="mood-indicator">ðŸŒŸ</span>
            <span>All Moods</span>
        </a>
        {% for mood, label in moods %}
        <a href="?{% if query %}q={{ query }}&{% endif %}mood={{ mood }}" 
           class="mood-filter {% if current_mood == mood %}active{% endif %}">
            <span class="mood-indicator">
                {% if mood == 'happy' %}ðŸ˜Š
                {% elif mood == 'sad' %}ðŸ˜¢
                {% elif mood == 'angry' %}ðŸ˜ 
                {% elif mood == 'lonely' %}ðŸ˜”
                {% elif mood == 'depressed' %}ðŸ˜ž
                {% elif mood == 'excited' %}ðŸ˜ƒ
                {% elif mood == 'peaceful' %}ðŸ˜Œ
                {% endif %}
            </span>
            <span>{{ label }}</span>
        </a>
        {% endfor %}
    </div>
</div>

{% if entries %}
    {% for entry in entries %}
    <article class="entry-card">
        <div class="entry-header">
            <div>
                <span class="mood-indicator mood-{{ entry.mood }}">
                    {% if entry.mood == 'happy' %}ðŸ˜Š
                    {% elif entry.mood == 'sad' %}ðŸ˜¢
                    {% elif entry.mood == 'angry' %}ðŸ˜ 
                    {% elif entry.mood == 'lonely' %}ðŸ˜”
                    {% elif entry.mood == 'depressed' %}ðŸ˜ž
                    {% elif entry.mood == 'excited' %}ðŸ˜ƒ
                    {% elif entry.mood == 'peaceful' %}ðŸ˜Œ
                    {% endif %}
                </span>
                <h3 class="entry-title d-inline">{{ entry.title }}</h3>
            </div>
            <span class="entry-date">{{ entry.created_at|date:"F j, Y" }}</span>
        </div>

        <div class="entry-content" 
             style="font-size: {{ entry.font_size }}px; 
                    font-family: {{ entry.font_style }};
                    {% if entry.is_bold %}font-weight: bold;{% endif %}
                    {% if entry.is_italic %}font-style: italic;{% endif %}
                    {% if entry.is_underline %}text-decoration: underline;{% endif %}
                    {% if entry.is_strikethrough %}text-decoration: line-through;{% endif %}">
            {{ entry.content|linebreaks }}
        </div>

        <div class="entry-actions">
            <a href="{% url 'edit_entry' entry.pk %}" class="btn btn-outline-primary btn-action">
                <i class="bi bi-pencil"></i> Edit
            </a>
            <form action="{% url 'delete_entry' entry.pk %}" method="POST" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-danger btn-action" 
                        onclick="return confirm('Are you sure you want to delete this entry?')">
                    <i class="bi bi-trash"></i> Delete
                </button>
            </form>
        </div>
    </article>
    {% endfor %}
{% else %}
    <div class="no-results">
        <h3>No entries found</h3>
        <p class="text-muted">
            {% if query %}
                Try different search terms or mood filters
            {% else %}
                No entries match the selected mood filter
            {% endif %}
        </p>
        <div class="mt-3">
            <a href="{% url 'home' %}" class="btn btn-outline-primary">
                <i class="bi bi-house"></i> Back to Home
            </a>
            <a href="{% url 'new_entry' %}" class="btn btn-primary">
                <i class="bi bi-plus-lg"></i> Create New Entry
            </a>
        </div>
    </div>
{% endif %}
{% endblock %}